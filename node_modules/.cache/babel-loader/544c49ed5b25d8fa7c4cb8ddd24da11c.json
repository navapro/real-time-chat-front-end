{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/projects/Documents/GitHub/real-time-chat-front-end/public/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";import _asyncToGenerator from\"/Users/projects/Documents/GitHub/real-time-chat-front-end/public/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/projects/Documents/GitHub/real-time-chat-front-end/public/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _templateObject;import _regeneratorRuntime from\"/Users/projects/Documents/GitHub/real-time-chat-front-end/public/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState,useRef}from\"react\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{io}from\"socket.io-client\";import styled from\"styled-components\";import{allUsersRoute,host}from\"../utils/APIRoutes\";import ChatContainer from\"../components/ChatContainer\";import Contacts from\"../components/Contacts\";import Welcome from\"../components/Welcome\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Chat(){var navigate=useNavigate();var socket=useRef();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),contacts=_useState2[0],setContacts=_useState2[1];var _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),currentChat=_useState4[0],setCurrentChat=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),currentUser=_useState6[0],setCurrentUser=_useState6[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(localStorage.getItem(process.env.REACT_APP_LOCALHOST_KEY)){_context.next=4;break;}navigate(\"/login\");_context.next=9;break;case 4:_context.t0=setCurrentUser;_context.next=7;return JSON.parse(localStorage.getItem(process.env.REACT_APP_LOCALHOST_KEY));case 7:_context.t1=_context.sent;(0,_context.t0)(_context.t1);case 9:case\"end\":return _context.stop();}}},_callee);})),[]);useEffect(function(){if(currentUser){socket.current=io(host);socket.current.emit(\"add-user\",currentUser._id);}},[currentUser]);useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!currentUser){_context2.next=9;break;}if(!currentUser.isAvatarImageSet){_context2.next=8;break;}_context2.next=4;return axios.get(\"\".concat(allUsersRoute,\"/\").concat(currentUser._id));case 4:data=_context2.sent;setContacts(data.data);_context2.next=9;break;case 8:navigate(\"/setAvatar\");case 9:case\"end\":return _context2.stop();}}},_callee2);})),[currentUser]);var handleChatChange=function handleChatChange(chat){setCurrentChat(chat);};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(Contacts,{contacts:contacts,changeChat:handleChatChange}),currentChat===undefined?/*#__PURE__*/_jsx(Welcome,{}):/*#__PURE__*/_jsx(ChatContainer,{currentChat:currentChat,socket:socket})]})})});}var Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  height: 100vh;\\n  width: 100vw;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  gap: 1rem;\\n  align-items: center;\\n  background-color: #131324;\\n  .container {\\n    height: 85vh;\\n    width: 85vw;\\n    background-color: #00000076;\\n    display: grid;\\n    grid-template-columns: 25% 75%;\\n    @media screen and (min-width: 720px) and (max-width: 1080px) {\\n      grid-template-columns: 35% 65%;\\n    }\\n  }\\n\"])));","map":{"version":3,"sources":["/Users/projects/Documents/GitHub/real-time-chat-front-end/public/src/pages/Chat.jsx"],"names":["React","useEffect","useState","useRef","axios","useNavigate","io","styled","allUsersRoute","host","ChatContainer","Contacts","Welcome","Chat","navigate","socket","contacts","setContacts","undefined","currentChat","setCurrentChat","currentUser","setCurrentUser","localStorage","getItem","process","env","REACT_APP_LOCALHOST_KEY","JSON","parse","current","emit","_id","isAvatarImageSet","get","data","handleChatChange","chat","Container","div"],"mappings":"+nBAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,CAAqCC,MAArC,KAAmD,OAAnD,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,OAASC,EAAT,KAAmB,kBAAnB,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CACA,OAASC,aAAT,CAAwBC,IAAxB,KAAoC,oBAApC,CACA,MAAOC,CAAAA,aAAP,KAA0B,6BAA1B,CACA,MAAOC,CAAAA,QAAP,KAAqB,wBAArB,CACA,MAAOC,CAAAA,OAAP,KAAoB,uBAApB,C,6IAEA,cAAe,SAASC,CAAAA,IAAT,EAAgB,CAC7B,GAAMC,CAAAA,QAAQ,CAAGT,WAAW,EAA5B,CACA,GAAMU,CAAAA,MAAM,CAAGZ,MAAM,EAArB,CACA,cAAgCD,QAAQ,CAAC,EAAD,CAAxC,wCAAOc,QAAP,eAAiBC,WAAjB,eACA,eAAsCf,QAAQ,CAACgB,SAAD,CAA9C,yCAAOC,WAAP,eAAoBC,cAApB,eACA,eAAsClB,QAAQ,CAACgB,SAAD,CAA9C,yCAAOG,WAAP,eAAoBC,cAApB,eACArB,SAAS,sEAAC,sIACHsB,YAAY,CAACC,OAAb,CAAqBC,OAAO,CAACC,GAAR,CAAYC,uBAAjC,CADG,yBAENb,QAAQ,CAAC,QAAD,CAAR,CAFM,yCAINQ,cAJM,uBAKEM,CAAAA,IAAI,CAACC,KAAL,CACJN,YAAY,CAACC,OAAb,CAAqBC,OAAO,CAACC,GAAR,CAAYC,uBAAjC,CADI,CALF,qHAAD,GAUN,EAVM,CAAT,CAWA1B,SAAS,CAAC,UAAM,CACd,GAAIoB,WAAJ,CAAiB,CACfN,MAAM,CAACe,OAAP,CAAiBxB,EAAE,CAACG,IAAD,CAAnB,CACAM,MAAM,CAACe,OAAP,CAAeC,IAAf,CAAoB,UAApB,CAAgCV,WAAW,CAACW,GAA5C,EACD,CACF,CALQ,CAKN,CAACX,WAAD,CALM,CAAT,CAOApB,SAAS,sEAAC,qJACJoB,WADI,8BAEFA,WAAW,CAACY,gBAFV,iDAGe7B,CAAAA,KAAK,CAAC8B,GAAN,WAAa1B,aAAb,aAA8Ba,WAAW,CAACW,GAA1C,EAHf,QAGEG,IAHF,gBAIJlB,WAAW,CAACkB,IAAI,CAACA,IAAN,CAAX,CAJI,8BAMJrB,QAAQ,CAAC,YAAD,CAAR,CANI,wDAAD,GASN,CAACO,WAAD,CATM,CAAT,CAUA,GAAMe,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACC,IAAD,CAAU,CACjCjB,cAAc,CAACiB,IAAD,CAAd,CACD,CAFD,CAGA,mBACE,sCACE,KAAC,SAAD,wBACE,aAAK,SAAS,CAAC,WAAf,wBACE,KAAC,QAAD,EAAU,QAAQ,CAAErB,QAApB,CAA8B,UAAU,CAAEoB,gBAA1C,EADF,CAEGjB,WAAW,GAAKD,SAAhB,cACC,KAAC,OAAD,IADD,cAGC,KAAC,aAAD,EAAe,WAAW,CAAEC,WAA5B,CAAyC,MAAM,CAAEJ,MAAjD,EALJ,GADF,EADF,EADF,CAcD,CAED,GAAMuB,CAAAA,SAAS,CAAG/B,MAAM,CAACgC,GAAV,0fAAf","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { io } from \"socket.io-client\";\nimport styled from \"styled-components\";\nimport { allUsersRoute, host } from \"../utils/APIRoutes\";\nimport ChatContainer from \"../components/ChatContainer\";\nimport Contacts from \"../components/Contacts\";\nimport Welcome from \"../components/Welcome\";\n\nexport default function Chat() {\n  const navigate = useNavigate();\n  const socket = useRef();\n  const [contacts, setContacts] = useState([]);\n  const [currentChat, setCurrentChat] = useState(undefined);\n  const [currentUser, setCurrentUser] = useState(undefined);\n  useEffect(async () => {\n    if (!localStorage.getItem(process.env.REACT_APP_LOCALHOST_KEY)) {\n      navigate(\"/login\");\n    } else {\n      setCurrentUser(\n        await JSON.parse(\n          localStorage.getItem(process.env.REACT_APP_LOCALHOST_KEY)\n        )\n      );\n    }\n  }, []);\n  useEffect(() => {\n    if (currentUser) {\n      socket.current = io(host);\n      socket.current.emit(\"add-user\", currentUser._id);\n    }\n  }, [currentUser]);\n\n  useEffect(async () => {\n    if (currentUser) {\n      if (currentUser.isAvatarImageSet) {\n        const data = await axios.get(`${allUsersRoute}/${currentUser._id}`);\n        setContacts(data.data);\n      } else {\n        navigate(\"/setAvatar\");\n      }\n    }\n  }, [currentUser]);\n  const handleChatChange = (chat) => {\n    setCurrentChat(chat);\n  };\n  return (\n    <>\n      <Container>\n        <div className=\"container\">\n          <Contacts contacts={contacts} changeChat={handleChatChange} />\n          {currentChat === undefined ? (\n            <Welcome />\n          ) : (\n            <ChatContainer currentChat={currentChat} socket={socket} />\n          )}\n        </div>\n      </Container>\n    </>\n  );\n}\n\nconst Container = styled.div`\n  height: 100vh;\n  width: 100vw;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  gap: 1rem;\n  align-items: center;\n  background-color: #131324;\n  .container {\n    height: 85vh;\n    width: 85vw;\n    background-color: #00000076;\n    display: grid;\n    grid-template-columns: 25% 75%;\n    @media screen and (min-width: 720px) and (max-width: 1080px) {\n      grid-template-columns: 35% 65%;\n    }\n  }\n`;\n"]},"metadata":{},"sourceType":"module"}